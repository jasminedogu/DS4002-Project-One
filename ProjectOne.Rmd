---
title: "Project-One-Group-3"
author: "Jasmine Dogu, Brian Wimmer, Christos Chen - Group 3"
date: "01/04/2021"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
    toc_float: yes
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(dplyr)
library(ggplot2)
library(plyr)
library(mlbench)
library(GGally)
library(mltools)
library(data.table)
library(caret)
set.seed(03092000)
```

# Research Question and Hypotheses  
**Goal**: Through this project, our group hopes to utilize both the **Support Vector Machine** (SVM) and **Random Forest Classifier** models to predict whether a person is or is not going to get the H1N1 vaccine. These two algorithms were selected for the reasons that are provided below in the "Why Support Vector Machine and Random Forest Classifier" section. 

We will first begin by explaining some background information on the H1N1 virus, the dataset, and the two machine learning algorithms. From there, we will proceed with the model creation and the parameter tuning. Lastly, we will draw conclusions from our findings and discuss future applications. 

**General Question**: Will the SVM or the Random Forest Model Predict the Likelihood of a Person Getting the H1N1 Vaccine Better?

**Null Hypothesis**: The SVM Polynomial Kernel will not outperform the Random Forest Classifier Model with regards to its F1 Score 
**Alternative Hypothesis**: The SVM Polynomial Kernel will outperform the Random Forest Classifier Model with regards to its F1 Score

**Note**: The F1 score was the metric used to primarily evaluate the two models. To determine if the F1 scores are statistically significant, a **t-test** will be utilized. More information about this can be found in the "Why F1 Score" section below.

# Why a Focus on F1 Score  
![Reference 3](f1.png)

Throughout our project, we will be looking at multiple metrics to evaluate the performance of the SVM and Random Forest models. These include **accuracy, precision (specificity), and recall (sensitivity)**. While all of these metrics will play a role in how we tune the models' parameter and determine which model is more successful, to answer our question of which model outperforms the other we will be looking at the **F1 value**. 

**The F1 value is the harmonic mean of the sensitivity and specificity rates**, and it gives a better measure of the incorrectly classified cases than the accuracy metric would. It is scaled from 0 to 1, with 1 being the best. Because there is an imbalanced class distribution in our dataset, we will be analyzing the F1 score as it is a better indicator of which model is performing better. After getting the F1 scores for both the SVM and the Random Forest models, we will be utilizing a t-test to determine if the difference between the F1 scores of the models is due to chance or is statistically significant. This will determine whether a model outperforms the other.

An explanation of why the SVM and Random Forest models were specifically selected for this project will be explained later after some data cleaning. 

# Background on H1N1
The flu is an illness that is caused by the influenza virus, which can lead to various symptoms that include, but are not limited to, high fevers and sore throats. The Swine Flu, in particular, is a novel influenza A (H1N1) virus that emerged in Spring 2009. It is a subtype of the Influenza A Virus and is considered an **orthomyxovirus** that contains the glycoproteins **haemagglutinin** and **neuraminidase**. The Swine Flu was initially detected in the United States, eventually spreading to the rest of the world. It is said to have "contained a blend of flu genes that hadn't been previously seen in animals or people." The Swine Flu, although very similar to the Seasonal Flu, was found to be more contagious, and less people were found to have existing resistance. (Reference 2)


# About the Dataset  
The selected dataset for this project is originally from the National 2009 H1N1 Flu Survey but can also be found on [Driven Data](https://www.drivendata.org/competitions/66/flu-shot-learning/page/210/). 

Before building our machine learning algorithms, having a clear understanding of the data is critical. We must familiarize ourselves with the origin, size, key characteristics, behavior, and type of data. Our dataset is originally composed of **38 columns** and **26,707 observations**. Each observation accounts for one person who responded to the National 2009 H1N1 Flu Survey. There are five general groupings that each feature falls into. These data categories can be found below with a few examples of the types of variables that would belong to it: 

1. Presumptions
- h1n1_concern, h1n1_knowledge
2. Behavioral: public health measure and avoidance strategies
- behavioral_face_mask, behavioral_large_gatherings, behavioral_touch_face
3. Opinion: respondent’s opinion regarding the vaccine
- opinion_h1n1_risk, opinion_h1n1_sick_from_vacc
4. Demographics
- age_group, income_poverty, education, hhs_geo_region
5. Health Considerations: doctor recommendations, conditions
- doctor_recc_h1n1, chronic_med_condition, health_insurance

According to the CDC, initially there were **734,367 landline numbers** that were considered. After being narrowed down due to the unresponsiveness or the age of the respondent, a total of **105,499** respondents that were adults were found eligible. However, only **43.2%** of these individuals completed the interview. It is fair to assume that there is a **non-response bias** in play with the survey. This is important to keep in mind as it can be a source of explanation as to why the data may be imbalanced. It is very likely that individuals who were pro-vaccination were more likely to want to answer the National 2009 H1N1 Flu Survey, therefore, skewing the results. (Reference 1)

With responses from both the **adults and the children**, the CDC states that there are a total of **56,656** people who responded to the National 2009 H1N1 Flu Survey; these were composed of both landline and cellphone interviews. In our dataset, because we only have data for **26,707** respondents, it is safe to assume that the dataset is a sample of the original National 2009 H1N1 Flu Survey. (Reference 1)

Before getting into the details of why the SVM and Random Forest models were selected, we must clean the data and get a better understanding of it.

# Data Cleaning {.tabset}

## Reading in the Dataset
```{r, include=FALSE}
df_features <- read.csv("training_set_features.csv")
df_label <- read.csv("training_set_labels.csv")
df <- merge(df_features,df_label,by="respondent_id")
#head(df)
#sum(nrow(df))
```
The original dataset was provided in two csv files. To begin our analysis, we must first combine the two into one dataframe. This is because one csv file has the features we are interested in while the other has the labels for our observations (whether the individual received the H1N1 and Seasonal Flu Vaccine or not). We matched up each of the rows by the respondent_id, which was a column in both the features and the label csv files. 

## Removing the Seasonal Flu Columns
```{r}
df <- df[, -which(names(df) %in% c("doctor_recc_seasonal","opinion_seas_vacc_effective","opinion_seas_risk","opinion_seas_sick_from_vacc", "seasonal_vaccine"))]
head(df)
```
Given the recent COVID-19 pandemic, our group chose to focus only on the vaccination for H1N1, which is also known as the Swine Flu. We believe that our findings will be interesting in regards to comparing it to COVID-19. Therefore, we removed the five columns that only dealt with the Seasonal Flu.  

H1N1 was still seen as a “new virus”, although it was a different strain of the seasonal flu. Similarly, the COVID-19 virus and pandemic is also new and relatively unknown. We should be able to draw some similarities between skepticism and opinions regarding vaccinations between the two viruses.

## Looking at the Structure of the Data: Type and NA's
```{r}
str(df)
```
Looking at the structure of the dataset, we notice a few things. Initially, we notice that there are a few empty strings in some of the variables, for example employment_occupation and empoloyment_industry, that we want to convert to NA's. This will make it easier for us when we are analyzing the number of missing datapoints we have in order to figure out what variables we may want to consider dropping. Additionally, all of these variables must be converted to factors. This is because of the nature of the survey and types of variables we have present. 

We notice that for certain variables, specifically hhs_geo_region, employment_industry, and employment_occupation, these use a classification defined by the U.S. Dept. of Health and Human Services. Because these variables are encoded for confidentiality  purposes, and the encoding is not provided online, we are unable to make use these variables. Therefore, these columns will be dropped from the dataset.

## Changing the Empty Strings
```{r}
df <- replace(df, df == "", NA)
```
Here, we replaced all rows with empty strings to contain the value "NA" instead. This will come in handy as we proceed with the analysis.

## Looking at Na's and Removing Specific Columns
```{r}
colSums(is.na(df))
```
Looking at the number of NA's we have present in each column, we can see that the health_insurance, employment_industry, and employment_occupation make up the top 3 columns with the highest amount of NA's.

We decided to remove the health_insurance column for a few reasons. It was the main source of NA's within the dataset (12,274), and deleting rows associated with this column would have effectively eliminated nearly half of the dataset. In addition, we did some further research into the financial obligations regarding the H1N1 vaccine. According to the Centers for Disease Control (CDC), the government wanted to avoid any economic obstacles for everyday Americans when it came to obtaining a vaccine. Vaccination providers, such as clinics or drugstores, were not allowed to charge volunteers for the vaccine, as the supplies had already been purchased by the US Government. This allowed us to conclude that health insurance, therefore, would not be as necessary or as big of an obstacle for obtaining the H1N1 vaccine, in comparison to others. Further information can be found [here](https://www.cdc.gov/h1n1flu/vaccination/statelocal/vaccine_financing.htm).

We also chose to remove the employment_industry and employment_occupation variables. Similarly to health_insurance, removing observations with “NA” for these two variables would have resulted in nearly half of our dataset being eliminated. These variables include “codes” that are correlated to US Census data regarding industry and occupation types. Converting these to factor variables and then taking the average or median to engineer data for the NA's would be inaccurate. We would be left with very high numbers of one particular industry and occupation, which would not help the model in determining if people would get an H1N1 vaccine or not.

Lastly, we removed the respondent_id at this step. This variable was important when we were matching the features to the labels. However, for the machine learning algorithm, it is not needed.

```{r}
df <- df[, -which(names(df) %in% c("employment_occupation","health_insurance","employment_industry", "hhs_geo_region", "respondent_id"))]
df<- na.omit(df)
#write.csv(df,"df2.csv", row.names = TRUE) #saving to a new csv file
df2<- read.csv("df2.csv")  
nrow(df)
```
Here, along with removing the top 3 columns with the highest number of NA's, we also removed the hhs_geo_region variable for reasons mentioned above. We are left with 19,656 observations. Because this is still a significant portion of the original number of observations the dataset had (approximately 73.6%), we proceed with our analysis.

In this step of our project, we decided to save the current dataframe to a new csv file. This is because in the next step we will be coercing all of the features to factors; therefore, it is a good idea to keep a copy of the clean data that contains all of the features' data types as they originally were.

## Coercing the Variables to Factors
```{r}
df[,] <- lapply(df[,], factor)  ## as.factor() could also be used
str(df)
#write.csv(df,"cleaned_df.csv", row.names = TRUE) #saving to a new csv file
```
After this step, we can verify that all of the variables are now factors by using the str() function. Because they are all factors, we can carry on with our analysis.

# Why Support Vector Machine and Random Forest Classifier  
```{r, message = FALSE, warnings = FALSE}
library(dplyr)
library(tidyverse)
pie( c( nrow(df %>% filter(h1n1_vaccine==0)), nrow(df %>% filter(h1n1_vaccine==1))), labels = c("Not Vaccinated, 77%", "Got Vaccinated, 23%"),border = "white", col= c("#015977", "#606DA2"), main = "Base Rate of H1N1 Vaccinations" )
```

After a preliminary analysis of the data topology, our group decided to compare the SVM and Random Forest models. We were curious to how these two models would perform against one another due to the nature of the algorithms. Both are **supervised machine learning algorithms** which can be used for **classification** or **regression** analysis. For the purposes of our analysis, we will be using these algorithms to classify which group a person, given various features, is likely to belong to (vaccine/no vaccine). We selected these algorithms because they are both great for imbalanced datasets, which as we can see above, our dataset has a base rate of 23% for the group who received the vaccine; because our dataset is imbalanced, it is critical to utilize algorithms that can deal with it fairly well. Similarly, both of the algorithms reduce the risk of over-fitting in their own manner. This is also extremely important for our model as overfitting to the dataset can falsely skew the accuracy of the model.

In theory, the Random Forest model would have a few benefits over the SVM model. The Random Forest is non-parametric, so outliers would not be an issue for the algorithm. Similarly, they are extremely easy to build (compared to SVMs) and are fast/scalable. Unlike with SVMs, Random Forests do not require a lot of parameter tuning. These are all characteristics of the algorithm that make it extremely favorable for this research study.

However, the SVM model also has a few general benefits over the Random Forest model. Usually, the SVM model is known to be highly efficient and accurate. Similarly, the SVM model scales well to high dimensional data, which is not significantly relevant for our dataset as we have more observations than we do features. However, the main reason why we predict that the SVM model will outperform the Random Forest model is because of the kernels that the SVM model uses. With an appropriate kernel and degree of the kernel, we can expect the algorithm to work extremely well even if the data is not linearly separable in the base feature space, which in this instance applies to our dataset.

In order to begin building our model, we now proceed to the EDA, followed by the feature selection. These are two sections that will help us gain a better understanding of the dataset and re-adjust our hypotheses, if needed. 

# EDA {.tabset}

In order to continue with the project, we first wanted to explore the data and to try to get an idea of the types of people within the dataset that may choose to get the vaccine. For this, we decided to create histograms depicting different features from each of the categories we had: presumptions, behavioral, opinion, demographic, and health considerations.

## Histogram for "Presumptions" Variables
```{r}
pre_1 <- ggplot(df2, aes(x=h1n1_concern)) +
  geom_histogram(stat="count",bins=4,fill="#015977",color="black")+xlab("Level of H1N1 Concern") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
pre_1
```

Over 70 percent of respondents presented a moderate level of concern regarding H1N1. 11.5% and 16.2% indicated "not at all concerned" and "very concerned", respectively. We would expect those that indicated "very concerned" to be the most likely to get the H1N1 vaccine.

0-Not at all concerned  
1-Not very concerned  
2-Somewhat concerned  
3-Very concerned  

```{r}
pre_2 <- ggplot(df2, aes(x=h1n1_knowledge)) + 
  geom_histogram(stat="count",bins=3,fill="#015977",color="black")+xlab("Level of H1N1 Knowledge") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
pre_2
```

The histogram shows there to be a suprisingly large proportion of respondents that indicated "A lot of knowledge" of the H1N1 Virus, with 37%. Only 7% indicated "No knowledge". We would expect the majority of those that reported having "A lot of knowledge" to want the vaccine, when compared to those reporting "No knowledge".

0-No knowledge  
1-A little knowledge  
2-A lot of knowledge  

## Histogram for "Behavioral" Variables
```{r}
beh1 <- ggplot(df2, aes(x=behavioral_wash_hands)) + 
  geom_histogram(stat="count",bins=2,fill="#35648F",color="black")+xlab("Frequent Hand Washing / Hand Sanitizer Use") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
beh1
```

17% of respondents indicated infrequent hand washing and lack of sanitizer use, while 83% indicated the opposite. We would expect those that reported frequent usage to be more likely to get the H1N1 vaccine, as this indicates more self-awareness of healthy habits and the presence of germs.

0-No  
1-Yes  

```{r}
beh2 <- ggplot(df2, aes(x=behavioral_large_gatherings)) + 
  geom_histogram(stat="count",bins=2,fill="#35648F",color="black")+xlab("Avoidance of Large Gatherings") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
beh2
```

65% of respondents indicated NOT avoiding large gatherings during the H1N1 crisis, while 35% indicated the opposite. We would expect those that indicated that they practiced avoidance measures to be more likely to get the H1N1 vaccine, as they would seem to be more worried of the risks of the virus.

0-No  
1-Yes  

## Histogram for "Opinion" Variables
```{r}
opi1 <- ggplot(df2, aes(x=opinion_h1n1_risk)) + 
  geom_histogram(stat="count",bins=5,fill="#606DA2",color="black")+xlab("Opinion of H1N1 Risk") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
opi1
```

There is a relatively large disparity between opinions regarding H1N1 risk. Nearly 70% of respondents indicated the risk to be "Very Low" or "Somewhat Low", while only 28.2% indicated the risk posed by H1N1 to be "Somewhat High" or "Very High".  

1-Very Low  
2-Somewhat Low  
3-Don't Know  
4-Somewhat High  
5-Very High  

```{r}
opi2 <- ggplot(df2, aes(x=opinion_h1n1_sick_from_vacc)) + 
  geom_histogram(stat="count",bins=5,fill="#606DA2",color="black")+xlab("Opinion of Sickness from H1N1 Vaccine") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
opi2
```

There is a relatively large disparity between opinions regarding getting sick from the H1N1 vaccince. 69.5% of respondents indicated the risk of sickness to be "Not at all worried" or "Somewhat Worried", while only 30.2% indicated the risk of sickness to be "Somewhat Worried" or "Very Worried".

1-Not at all worried  
2-Not very worried    
3-Don't know  
4-Somewhat worried  
5-Very worried  

## Histogram for "Demographics" Variables
```{r}
dem1 <- ggplot(df2, aes(x=age_group)) + 
  geom_histogram(stat="count",fill="#8C74AE",color="black")+xlab("Age Group")
dem1
```

The 65+ age group was the most represented among respondents, while the 35-44 was the least represented.


```{r}
dem2 <- ggplot(df2, aes(x=education)) + 
  geom_histogram(stat="count",fill="#8C74AE",color="black")+xlab("Level of Education")
dem2
```

The majority of respondents indicated having at least some college. The most represented group were College Graduates.


```{r}
dem3 <- ggplot(df2, aes(x=employment_status)) + 
  geom_histogram(stat="count",fill="#8C74AE",color="black")+xlab("Employment Status")
dem3
```

Over 50% of respondents indicated that they were employed.


## Histogram for "Health Considerations" Variables
```{r}
hc1 <- ggplot(df2, aes(x=doctor_recc_h1n1)) + 
  geom_histogram(stat="count",bins=2,fill="#B77AB0",color="black")+xlab("Doctor Recommendation of H1N1 Vaccine") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
hc1
```

77% of respondents indicated that their doctor did NOT recommend getting the H1N1 Vaccine, while only 23% indicated the presence of a recommendation.

0-No  
1-Yes  

```{r}
hc2 <- ggplot(df2, aes(x=chronic_med_condition)) + 
  geom_histogram(stat="count",bins=2,fill="#B77AB0",color="black")+xlab("Chronic Medical Condition") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5)
hc2
```

72% or respondents indicated NOT having a chronic medical condition, while 28% indicated the presence of a chronic medical condition.
0-No  
1-Yes  

# Feature Selection {.tabset}

## Corellogram 
```{r, message = FALSE, warnings = FALSE}
h1n1_correlation = ggcorr(df2, method = c("everything", "pearson"), title = "H1N1 Factors Correlogram")
h1n1_correlation
```

A correlogram was utilized to inform and guide future efforts for feature selection. We aimed to identify variables weakly and strongly correlated to the target variable and then test model performance with & without those variables. As demonstrated above, none of the variables are particularly strongly correlated with whether someone relieved the h1n1 vaccination. However, the most correlated are **doctor recommendation**, **opinion about the risk of getting sick with the flu vaccine**, and their **opinion of whether or not the h1n1 vaccine was effective** with correlations of **0.13**, **0.11**, and **0.09** respectively.

Because we determined that no variables were highly correlated, we will not have to remove any of the features and can move on to the LASSO Regression.

## LASSO Regression Model 

### Why LASSO Regression

Initially, we want to utilize lasso regression to reduce the feature space. LASSO regression is an analysis method that utilizes both variable selection and regularization to further enhance the predictive accuracy and interpretability. It imposes a constraint on the model parameters that causes the regression coefficients for some of the variables to shrink towards zero.

### Preparing the Data
```{r}
set.seed(03092000)
library(mltools)
library(data.table)

# Split the data into training and test set
training.samples <- df$h1n1_vaccine %>% 
  createDataPartition(p = 0.8, list = FALSE)
train.data  <- df[training.samples, ]
test.data <- df[-training.samples, ]

#newdata <- one_hot(as.data.table(df))

# Dummy code categorical predictor variables
x <- model.matrix(h1n1_vaccine~., train.data)[,]
# Convert the outcome (class) to a numerical variable
y <- ifelse(train.data$h1n1_vaccine == 1, 1, 0)
```

### Computing Penalized Logistic Regression
```{r}
set.seed(03092000)
library(glmnet)

#Computing the Penalized Logistic Regression
LASSO_Reg <-glmnet(x, y, family = "binomial", alpha = 1) 

#Fit the final model on the training data
model <- glmnet(x, y, alpha = 1, family = "binomial",
                lambda =  LASSO_Reg$lambda.min)

# Make predictions on the test data
x.test <- model.matrix(h1n1_vaccine ~., test.data)[,]
probabilities <- model %>% predict(newx = x.test)
predicted.classes <- ifelse(probabilities > 0.5, "pos", "neg")

coef(LASSO_Reg)  #display regression coefficients
plot(LASSO_Reg) #each lines a feature, the ones retained are the ones on the top 
```


```{r}
#getting the actual coefficient for lambda 
coeffs <- coef(LASSO_Reg, s = 0.1) 
coeffs.df <- data.frame(name = coeffs@Dimnames[[1]][coeffs@i + 1], coefficient = coeffs@x) 

# reordering the variables in term of coefficients
coeffs.df[order(coeffs.df$coefficient, decreasing = T),]

#cross-validation done by cv.glmnet
cv.fit <- cv.glmnet(x, y)
cv.fit

plot(cv.fit)

#1SE furthest to the right for lambda 
cv.fit$lambda.min

#Optimized run of the model 
optimal_reg <-glmnet(x, y, family = "binomial", alpha = 0.006919) 
plot(optimal_reg) #look back at the coefficients 
coef(optimal_reg)
```


```{r}
# create a function to transform coefficient of glmnet and cvglmnet to data.frame
coeff2dt <- function(fitobject, s) {
  coeffs <- coef(fitobject, s) 
  coeffs.dt <- data.frame(name = coeffs@Dimnames[[1]][coeffs@i + 1], coefficient = coeffs@x) 

  # reorder the variables in term of coefficients
  return(coeffs.dt[order(coeffs.dt$coefficient, decreasing = T),])
}

coeff2dt(fitobject = cv.fit, s = "lambda.min") %>% head(30)

#threshold - block method (prop.) 
```
# Creating a Lasso Coefficient Plot
```{r}
coeffs.table <- coeff2dt(fitobject = cv.fit, s = "lambda.min")
ggplot(data = coeffs.table) +
  geom_col(aes(x = name, y = coefficient, fill = {coefficient > 0})) +
  xlab(label = "") +
  ggtitle(expression(paste("Lasso Coefficients with ", lambda, " = 0.006919"))) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") 
```
#Isolate Variables of Interest 
```{r}
varOfInterestPos = coeff2dt(fitobject = cv.fit, s = "lambda.min") %>% filter(coefficient >= 0.03)
varOfInterestNeg = coeff2dt(fitobject = cv.fit, s = "lambda.min") %>% filter(coefficient <= -0.03)
varOfInterest = c( varOfInterestPos[,1], varOfInterestNeg[,1])
varOfInterestFinal = varOfInterest[varOfInterest != "(Intercept)"]
varOfInterestFinal
```
As can be seen above, there are 17 variables that we plan to utilize within our SVM model. This significant reduction of the feature space promotes sparcity and makes the model *"mean and lean"* as described by Professor Wright :) 

#One-Hot Encoding 
```{r}
library(mltools)
#df_onehot = one_hot(df, dropCols = TRUE) FLOP!

df_onehot = as.data.frame(as.matrix(sparse.model.matrix(~. -1, data = df)))

```
Using the mltools package, 

```{r}
df_onehot = df_onehot %>% 
  select( c(varOfInterestFinal, h1n1_vaccine1))

names(df_onehot)[18] <- "h1n1_vaccine"

```




# Future Direction for Project

Utilizing both the polynomial kernel and the radial kernel, we will explore tuning the hyperparameters and comparing the performance of each as they both possessed similar RMSE values. We initially ran multiple kernels and selected the Polynomial Kernel due to its low RMSE of 0.401, with the Radial Kernel following close behind at an RSME of 0.417. However, because these kernel’s performed very similarly with regard to our loss function, we would still like to further assess both kernels.

Following the execution of the SVM, we would like to proceed with the Random Forest and aim to tune the hyperparameters for optimal performance. Having tuned both of the models, the statistical significance of the resulting F1 Scores of each algorithm will be assessed for statistical significance with a t-test.


# SVM Model {.tabset}
Show in New WindowClear OutputExpand/Collapse Output
 
 
respondent_id
<int>
h1n1_concern
<int>
h1n1_knowledge
<int>
behavioral_antiviral_meds
<int>
1	0	1	0	0	
2	1	3	2	0	
3	2	1	1	0	
4	3	1	1	0	
5	4	2	1	0	
6	5	3	1	0	
6 rows | 1-5 of 33 columns
Show in New WindowClear OutputExpand/Collapse Output
'data.frame':	26707 obs. of  33 variables:
 $ respondent_id              : int  0 1 2 3 4 5 6 7 8 9 ...
 $ h1n1_concern               : int  1 3 1 1 2 3 0 1 0 2 ...
 $ h1n1_knowledge             : int  0 2 1 1 1 1 0 0 2 1 ...
 $ behavioral_antiviral_meds  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ behavioral_avoidance       : int  0 1 1 1 1 1 0 1 1 1 ...
 $ behavioral_face_mask       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ behavioral_wash_hands      : int  0 1 0 1 1 1 0 1 1 0 ...
 $ behavioral_large_gatherings: int  0 0 0 1 1 0 0 0 1 1 ...
 $ behavioral_outside_home    : int  1 1 0 0 0 0 0 0 1 0 ...
 $ behavioral_touch_face      : int  1 1 0 0 1 1 0 1 1 1 ...
 $ doctor_recc_h1n1           : int  0 0 NA 0 0 0 0 1 0 0 ...
 $ chronic_med_condition      : int  0 0 1 1 0 0 0 1 0 1 ...
 $ child_under_6_months       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ health_worker              : int  0 0 0 0 0 0 0 0 0 0 ...
 $ health_insurance           : int  1 1 NA NA NA NA NA 1 NA 1 ...
 $ opinion_h1n1_vacc_effective: int  3 5 3 3 3 5 4 5 4 4 ...
 $ opinion_h1n1_risk          : int  1 4 1 3 3 2 1 2 1 2 ...
 $ opinion_h1n1_sick_from_vacc: int  2 4 1 5 2 1 1 1 1 2 ...
 $ age_group                  : chr  "55 - 64 Years" "35 - 44 Years" "18 - 34 Years" "65+ Years" ...
 $ education                  : chr  "< 12 Years" "12 Years" "College Graduate" "12 Years" ...
 $ race                       : chr  "White" "White" "White" "White" ...
 $ sex                        : chr  "Female" "Male" "Male" "Female" ...
 $ income_poverty             : chr  "Below Poverty" "Below Poverty" "<= $75,000, Above Poverty" "Below Poverty" ...
 $ marital_status             : chr  "Not Married" "Not Married" "Not Married" "Not Married" ...
 $ rent_or_own                : chr  "Own" "Rent" "Own" "Rent" ...
 $ employment_status          : chr  "Not in Labor Force" "Employed" "Employed" "Not in Labor Force" ...
 $ hhs_geo_region             : chr  "oxchjgsf" "bhuqouqj" "qufhixun" "lrircsnp" ...
 $ census_msa                 : chr  "Non-MSA" "MSA, Not Principle  City" "MSA, Not Principle  City" "MSA, Principle City" ...
 $ household_adults           : int  0 0 2 0 1 2 0 2 1 0 ...
 $ household_children         : int  0 0 0 0 0 3 0 0 0 0 ...
 $ employment_industry        : chr  "" "pxcmvdjn" "rucpziij" "" ...
 $ employment_occupation      : chr  "" "xgwztkwe" "xtkaffoo" "" ...
 $ h1n1_vaccine               : int  0 0 0 0 0 0 0 1 0 0 ...
Show in New WindowClear OutputExpand/Collapse Output
              respondent_id                h1n1_concern              h1n1_knowledge 
                          0                          92                         116 
  behavioral_antiviral_meds        behavioral_avoidance        behavioral_face_mask 
                         71                         208                          19 
      behavioral_wash_hands behavioral_large_gatherings     behavioral_outside_home 
                         42                          87                          82 
      behavioral_touch_face            doctor_recc_h1n1       chronic_med_condition 
                        128                        2160                         971 
       child_under_6_months               health_worker            health_insurance 
                        820                         804                       12274 
opinion_h1n1_vacc_effective           opinion_h1n1_risk opinion_h1n1_sick_from_vacc 
                        391                         388                         395 
                  age_group                   education                        race 
                          0                        1407                           0 
                        sex              income_poverty              marital_status 
                          0                        4423                        1408 
                rent_or_own           employment_status              hhs_geo_region 
                       2042                        1463                           0 
                 census_msa            household_adults          household_children 
                          0                         249                         249 
        employment_industry       employment_occupation                h1n1_vaccine 
                      13330                       13470                           0 
Show in New WindowClear OutputExpand/Collapse Output
[1] 19656
Show in New WindowClear OutputExpand/Collapse Output
'data.frame':	19656 obs. of  28 variables:
 $ h1n1_concern               : Factor w/ 4 levels "0","1","2","3": 2 4 2 3 4 1 2 1 3 3 ...
 $ h1n1_knowledge             : Factor w/ 3 levels "0","1","2": 1 3 2 2 2 1 1 3 2 2 ...
 $ behavioral_antiviral_meds  : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
 $ behavioral_avoidance       : Factor w/ 2 levels "0","1": 1 2 2 2 2 1 2 2 2 2 ...
 $ behavioral_face_mask       : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
 $ behavioral_wash_hands      : Factor w/ 2 levels "0","1": 1 2 2 2 2 1 2 2 1 2 ...
 $ behavioral_large_gatherings: Factor w/ 2 levels "0","1": 1 1 2 2 1 1 1 2 2 2 ...
 $ behavioral_outside_home    : Factor w/ 2 levels "0","1": 2 2 1 1 1 1 1 2 1 1 ...
 $ behavioral_touch_face      : Factor w/ 2 levels "0","1": 2 2 1 2 2 1 2 2 2 1 ...
 $ doctor_recc_h1n1           : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 2 1 1 1 ...
 $ chronic_med_condition      : Factor w/ 2 levels "0","1": 1 1 2 1 1 1 2 1 2 2 ...
 $ child_under_6_months       : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 2 ...
 $ health_worker              : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
 $ opinion_h1n1_vacc_effective: Factor w/ 5 levels "1","2","3","4",..: 3 5 3 3 5 4 5 4 4 4 ...
 $ opinion_h1n1_risk          : Factor w/ 5 levels "1","2","3","4",..: 1 4 3 3 2 1 2 1 2 1 ...
 $ opinion_h1n1_sick_from_vacc: Factor w/ 5 levels "1","2","3","4",..: 2 4 5 2 1 1 1 1 2 2 ...
 $ age_group                  : Factor w/ 5 levels "18 - 34 Years",..: 4 2 5 3 5 4 3 3 4 3 ...
 $ education                  : Factor w/ 4 levels "< 12 Years","12 Years",..: 1 2 2 4 2 1 4 3 2 2 ...
 $ race                       : Factor w/ 4 levels "Black","Hispanic",..: 4 4 4 4 4 4 4 4 4 4 ...
 $ sex                        : Factor w/ 2 levels "Female","Male": 1 2 1 1 2 2 1 2 2 2 ...
 $ income_poverty             : Factor w/ 3 levels "<= $75,000, Above Poverty",..: 3 3 3 1 1 1 1 2 1 1 ...
 $ marital_status             : Factor w/ 2 levels "Married","Not Married": 2 2 2 1 1 2 1 1 2 1 ...
 $ rent_or_own                : Factor w/ 2 levels "Own","Rent": 1 2 2 1 1 1 1 1 1 2 ...
 $ employment_status          : Factor w/ 3 levels "Employed","Not in Labor Force",..: 2 1 2 1 1 1 1 1 2 1 ...
 $ census_msa                 : Factor w/ 3 levels "MSA, Not Principle  City",..: 3 1 2 1 2 1 3 1 1 1 ...
 $ household_adults           : Factor w/ 4 levels "0","1","2","3": 1 1 1 2 3 1 3 2 1 3 ...
 $ household_children         : Factor w/ 4 levels "0","1","2","3": 1 1 1 1 4 1 1 1 1 1 ...
 $ h1n1_vaccine               : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 2 1 1 2 ...
 - attr(*, "na.action")= 'omit' Named int [1:7051] 3 17 25 27 30 32 39 40 43 45 ...
  ..- attr(*, "names")= chr [1:7051] "3" "17" "25" "27" ...
Show in New WindowClear OutputExpand/Collapse Output

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

Ignoring unknown parameters: binwidth, bins, pad
R Console

Show in New WindowClear OutputExpand/Collapse Output

data in column(s) 'age_group', 'education', 'race', 'sex', 'income_poverty', 'marital_status', 'rent_or_own', 'employment_status', 'census_msa' are not numeric and were ignoredIgnoring unknown parameters: title
R Console

Show in New WindowClear OutputExpand/Collapse Output
Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.0-2
55 x 77 sparse Matrix of class "dgCMatrix"
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
                                                                                                          
(Intercept)                -1.209382 -1.255685 -1.298938 -1.339301 -1.376927 -1.435345 -1.493897 -1.548788
(Intercept)                 .         .         .         .         .         .         .         .       
h1n1_concern1               .         .         .         .         .         .         .         .       
h1n1_concern2               .         .         .         .         .         .         .         .       
h1n1_concern3               .         .         .         .         .         .         .         .       
h1n1_knowledge1             .         .         .         .         .         .         .         .       
h1n1_knowledge2             .         .         .         .         .         .         .         .       
behavioral_antiviral_meds1  .         .         .         .         .         .         .         .       
behavioral_avoidance1       .         .         .         .         .         .         .         .       
behavioral_face_mask1       .         .         .         .         .         .         .         .       
behavioral_wash_hands1      .         .         .         .         .         .         .         .       
                                                                                                         
(Intercept)                -1.609843 -1.668887 -1.72994 -1.794432 -1.855326 -1.912651 -1.966904 -2.018038
(Intercept)                 .         .         .        .         .         .         .         .       
h1n1_concern1               .         .         .        .         .         .         .         .       
h1n1_concern2               .         .         .        .         .         .         .         .       
h1n1_concern3               .         .         .        .         .         .         .         .       
h1n1_knowledge1             .         .         .        .         .         .         .         .       
h1n1_knowledge2             .         .         .        .         .         .         .         .       
behavioral_antiviral_meds1  .         .         .        .         .         .         .         .       
behavioral_avoidance1       .         .         .        .         .         .         .         .       
behavioral_face_mask1       .         .         .        .         .         .         .         .       
behavioral_wash_hands1      .         .         .        .         .         .         .         .       
                                                                                                    
(Intercept)                -2.066182 -2.111457 -2.153975 -2.193851 -2.2360269 -2.2774586 -2.31487394
(Intercept)                 .         .         .         .         .          .          .         
h1n1_concern1               .         .         .         .         .          .          .         
h1n1_concern2               .         .         .         .         .          .          .         
h1n1_concern3               .         .         .         .         .          .          .         
h1n1_knowledge1             .         .         .         .         .          .          .         
h1n1_knowledge2             .         .         .         .         0.0164968  0.0384243  0.05868207
behavioral_antiviral_meds1  .         .         .         .         .          .          .         
behavioral_avoidance1       .         .         .         .         .          .          .         
behavioral_face_mask1       .         .         .         .         .          .          .         
behavioral_wash_hands1      .         .         .         .         .          .          .         
                                                                                                        
(Intercept)                -2.34546815 -2.38102549 -2.43510135 -2.4881507 -2.5375562 -2.590699 -2.629023
(Intercept)                 .           .           .           .          .          .         .       
h1n1_concern1               .           .           .           .          .          .         .       
h1n1_concern2               .           .           .           .          .          .         .       
h1n1_concern3               .           .           .           .          .          .         .       
h1n1_knowledge1             .           .           .           .          .          .         .       
h1n1_knowledge2             0.07726947  0.09062287  0.09984205  0.1083073  0.1161241  0.123944  0.129912
behavioral_antiviral_meds1  .           .           .           .          .          .         .       
behavioral_avoidance1       .           .           .           .          .          .         .       
behavioral_face_mask1       .           .           .           .          .          .         .       
behavioral_wash_hands1      .           .           .           .          .          .         .       
                                                                                                        
(Intercept)                -2.6730201 -2.7194857289 -2.761021278 -2.8018955505 -2.837181035 -2.877343119
(Intercept)                 .          .             .            .             .            .          
h1n1_concern1               .          .             .            .             .            .          
h1n1_concern2               .          0.0007756943  0.007362524  0.0126010050  0.009301781  0.007194928
h1n1_concern3               .          .             .           -0.0002456473 -0.022331608 -0.041811170
h1n1_knowledge1             .          .             .            .             .            .          
h1n1_knowledge2             0.1352865  0.1398379048  0.143696129  0.1473463865  0.151618667  0.156314451
behavioral_antiviral_meds1  .          .             .            .             .            .          
behavioral_avoidance1       .          .             .            .             .            .          
behavioral_face_mask1       .          .             .            .             .            .          
behavioral_wash_hands1      .          .             .            .             .            .          
                                                                                                       
(Intercept)                -2.921388200 -3.008779707 -3.089465884 -3.16853057 -3.2478369041 -3.29661839
(Intercept)                 .            .            .            .           .             .         
h1n1_concern1               .            .            .            .           .             .         
h1n1_concern2               0.005162692  0.002071086  .            .           .             .         
h1n1_concern3              -0.059859358 -0.077583545 -0.091570956 -0.10296219 -0.1132367965 -0.12305941
h1n1_knowledge1             .            .            .            .           .             .         
h1n1_knowledge2             0.160668752  0.165132445  0.169286510  0.17324162  0.1767671631  0.17955724
behavioral_antiviral_meds1  .            .            .            .           .             .         
behavioral_avoidance1       .            .           -0.004784797 -0.01451704 -0.0234537947 -0.03129804
behavioral_face_mask1       .            .            .            .           0.0006071631  0.01257380
behavioral_wash_hands1      .            .            .            .           .             .         
                                                        
(Intercept)                -3.33976900 -3.3804843 ......
(Intercept)                 .           .         ......
h1n1_concern1               .           .         ......
h1n1_concern2               .           .         ......
h1n1_concern3              -0.13209380 -0.1404724 ......
h1n1_knowledge1             .           .         ......
h1n1_knowledge2             0.18209682  0.1844366 ......
behavioral_antiviral_meds1  .           .         ......
behavioral_avoidance1      -0.03851478 -0.0452014 ......
behavioral_face_mask1       0.02356153  0.0336106 ......
behavioral_wash_hands1      .           .         ......

 ..............................
 ........suppressing 33 columns and 33 rows in show(); maybe adjust 'options(max.print= *, width = *)'
 ..............................
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
                                                                                                         
rent_or_ownRent                     . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
employment_statusNot in Labor Force . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
employment_statusUnemployed         . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
census_msaMSA, Principle City       . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
census_msaNon-MSA                   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_adults1                   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_adults2                   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_adults3                   . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_children1                 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_children2                 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
household_children3                 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
                                                                                                     
rent_or_ownRent                     -0.0013731922 -0.002764700 -0.003800409 -0.005056338 -0.005719653
employment_statusNot in Labor Force  .             .            .            .            .          
employment_statusUnemployed          .             .            .            .            .          
census_msaMSA, Principle City        .             .            .            .            .          
census_msaNon-MSA                    .             .            .            0.001365044  0.009583429
household_adults1                    0.0001729497  0.006308414  0.011043012  0.014314481  0.017189561
household_adults2                    .             .            .            .            .          
household_adults3                    .             .           -0.006593699 -0.021332326 -0.034823592
household_children1                  .             .            .            .            .          
household_children2                  .             .            .            .            .          
household_children3                  .             .            .           -0.008318808 -0.016641272
                                                                                              
rent_or_ownRent                     -0.006209939 -0.007201697 -0.007907373 -0.008391458 ......
employment_statusNot in Labor Force  .            .            .            .           ......
employment_statusUnemployed          .            .           -0.001282338 -0.006342831 ......
census_msaMSA, Principle City        .            .            .            .           ......
census_msaNon-MSA                    0.016854029  0.023660096  0.029870518  0.035528212 ......
household_adults1                    0.019878017  0.022512277  0.025078375  0.027472437 ......
household_adults2                    .            .            .            .           ......
household_adults3                   -0.047382248 -0.059431888 -0.070647618 -0.080964811 ......
household_children1                  .            .            0.008429892  0.018366852 ......
household_children2                  .           -0.005530546 -0.010266249 -0.013970710 ......
household_children3                 -0.023924069 -0.032147561 -0.037587106 -0.041912554 ......
R Console


Show in New WindowClear OutputExpand/Collapse Output
 
 
name
<chr>
coefficient
<dbl>
2	doctor_recc_h1n11	0.8139730	
3	opinion_h1n1_vacc_effective5	0.1541054	
1	(Intercept)	-1.4715994	
3 rows
data.frame
3 x 2

Call:  cv.glmnet(x = x, y = y) 

Measure: Mean-Squared Error 

      Lambda Measure       SE Nonzero
min 0.000398  0.1259 0.001723      52
1se 0.007821  0.1275 0.001848      25
[1] 0.0003984087
55 x 100 sparse Matrix of class "dgCMatrix"
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
                                                                                                          
(Intercept)                -1.209382 -1.209746 -1.210146 -1.210584 -1.211344 -1.212323 -1.213686 -1.215297
(Intercept)                 .         .         .         .         .         .         .         .       
h1n1_concern1               .         .         .         .         .         .         .         .       
h1n1_concern2               .         .         .         .         .         .         .         .       
h1n1_concern3               .         .         .         .         .         .         .         .       
h1n1_knowledge1             .         .         .         .         .         .         .         .       
h1n1_knowledge2             .         .         .         .         .         .         .         .       
behavioral_antiviral_meds1  .         .         .         .         .         .         .         .       
behavioral_avoidance1       .         .         .         .         .         .         .         .       
behavioral_face_mask1       .         .         .         .         .         .         .         .       
behavioral_wash_hands1      .         .         .         .         .         .         .         .       
                                                                                                        
(Intercept)                -1.217204 -1.21951 -1.222033 -1.224793 -1.2278721288 -1.23167528 -1.235663233
(Intercept)                 .         .        .         .         .             .           .          
h1n1_concern1               .         .        .         .         .             .           .          
h1n1_concern2               .         .        .         .         .             .           .          
h1n1_concern3               .         .        .         .         .             .           .          
h1n1_knowledge1             .         .        .         .         .             .           .          
h1n1_knowledge2             .         .        .         .         0.0001609945  0.00151346  0.002983016
behavioral_antiviral_meds1  .         .        .         .         .             .           .          
behavioral_avoidance1       .         .        .         .         .             .           .          
behavioral_face_mask1       .         .        .         .         .             .           .          
behavioral_wash_hands1      .         .        .         .         .             .           .          
                                                                                                           
(Intercept)                -1.2396099202 -1.242703929 -1.2462032717 -1.2499432668 -1.255136092 -1.261535591
(Intercept)                 .             .            .             .             .            .          
h1n1_concern1               .             .            .            -0.0008961772 -0.002224020 -0.003634105
h1n1_concern2               .             .            .             .             .            .          
h1n1_concern3               .             .            0.0009268535  0.0026073519  0.004369200  0.006229094
h1n1_knowledge1            -0.0004927108 -0.001763296 -0.0031291674 -0.0045923246 -0.006154251 -0.007815738
h1n1_knowledge2             0.0045652182  0.006257283  0.0080838460  0.0100506518  0.012160869  0.014415917
behavioral_antiviral_meds1  .             .            .             .             .            .          
behavioral_avoidance1       .             .            .             .             .            .          
behavioral_face_mask1       .             .            .             .             0.001937142  0.004445762
behavioral_wash_hands1      .             .            .             .             0.001135421  0.002783687
                                                                                                        
(Intercept)                -1.269623098 -1.278896908 -1.288991345 -1.299767311 -1.311218011 -1.324196855
(Intercept)                 .            .            .            .            .            .          
h1n1_concern1              -0.005131837 -0.006688141 -0.008321415 -0.010031107 -0.011808702 -0.013658885
h1n1_concern2               .            0.001032990  0.002309067  0.003674804  0.005133711  0.006685851
h1n1_concern3               0.008194574  0.010293503  0.012504949  0.014813486  0.017199890  0.019680074
h1n1_knowledge1            -0.009575137 -0.011440413 -0.013412700 -0.015489767 -0.017666455 -0.019936244
h1n1_knowledge2             0.016813823  0.019367950  0.022085529  0.024967673  0.028011261  0.031208916
behavioral_antiviral_meds1  .            .            .            .            .            .          
behavioral_avoidance1       .            .            .            .            .            .          
behavioral_face_mask1       0.007118285  0.009962394  0.012978711  0.016163528  0.019508201  0.023023728
behavioral_wash_hands1      0.004521919  0.006356380  0.008294961  0.010335973  0.012472369  0.014709214
                                                                                                          
(Intercept)                -1.338711779 -1.3544426307 -1.371331241 -1.3895462041 -1.408897186 -1.429503485
(Intercept)                 .            .             .            .             .            .          
h1n1_concern1              -0.015578171 -0.0175522342 -0.019568722 -0.0216160859 -0.023683794 -0.025752678
h1n1_concern2               0.008333357  0.0100724551  0.011905077  0.0138263666  0.015838193  0.017953846
h1n1_concern3               0.022251404  0.0248935358  0.027585168  0.0303125045  0.033058167  0.035780904
h1n1_knowledge1            -0.022291311 -0.0247241102 -0.027223879 -0.0297817366 -0.032385527 -0.035023662
h1n1_knowledge2             0.034553215  0.0380392889  0.041660725  0.0454049611  0.049261582  0.053242217
behavioral_antiviral_meds1  .            0.0005093425  0.002632601  0.0048153203  0.007049000  0.009336126
behavioral_avoidance1       .            .             .            0.0004609287  0.001096209  0.001676985
behavioral_face_mask1       0.026709459  0.0305506085  0.034518899  0.0386142998  0.042821703  0.047116384
behavioral_wash_hands1      0.017045073  0.0194617462  0.021947634  0.0244824009  0.027061974  0.029682774
                                                                                                        
(Intercept)                -1.451280285 -1.474205376 -1.498025136 -1.522603056 -1.548121123 -1.574503484
(Intercept)                 .            .            .            .            .            .          
h1n1_concern1              -0.027805942 -0.029824348 -0.031785108 -0.033670897 -0.035458294 -0.037125433
h1n1_concern2               0.020163300  0.022463025  0.024846675  0.027306841  0.029839882  0.032438299
h1n1_concern3               0.038462794  0.041075442  0.043589599  0.045990068  0.048235748  0.050295110
h1n1_knowledge1            -0.037674887 -0.040319994 -0.042937971 -0.045505904 -0.048004843 -0.050412935
h1n1_knowledge2             0.057315099  0.061462169  0.065665600  0.069900651  0.074150399  0.078394198
behavioral_antiviral_meds1  0.011646318  0.013966372  0.016297461  0.018659253  0.021012661  0.023338757
behavioral_avoidance1       0.002185315  0.002605555  0.002920099  0.003113645  0.003171179  0.003076743
behavioral_face_mask1       0.051474147  0.055870077  0.060278932  0.064685031  0.069047040  0.073333894
behavioral_wash_hands1      0.032326507  0.034976280  0.037613799  0.040227256  0.042794811  0.045296084
                                                                                                 
(Intercept)                -1.601663583 -1.630103491 -1.659565791 -1.690061369 -1.72083811 ......
(Intercept)                 .            .            .            .            .          ......
h1n1_concern1              -0.038650479 -0.040006249 -0.041176802 -0.042142908 -0.04295701 ......
h1n1_concern2               0.035095712  0.037805980  0.040559221  0.043346350  0.04616795 ......
h1n1_concern3               0.052132215  0.053706076  0.054997131  0.055977903  0.05677870 ......
h1n1_knowledge1            -0.052706910 -0.054873004 -0.056890817 -0.058743808 -0.06041537 ......
h1n1_knowledge2             0.082612516  0.086799062  0.090929016  0.094988957  0.09894621 ......
behavioral_antiviral_meds1  0.025615783  0.027839088  0.029991381  0.032061791  0.03415889 ......
behavioral_avoidance1       0.002814809  0.002364112  0.001716831  0.000861435  .          ......
behavioral_face_mask1       0.077512003  0.081546042  0.085421202  0.089116387  0.09278779 ......
behavioral_wash_hands1      0.047710526  0.050018550  0.052204488  0.054251745  0.05624003 ......

 ..............................
 ........suppressing 56 columns and 33 rows in show(); maybe adjust 'options(max.print= *, width = *)'
 ..............................
   [[ suppressing 44 column names ‘s0’, ‘s1’, ‘s2’ ... ]]
                                                                                                         
rent_or_ownRent                     . . . . . . . . . . . . . . . . . . . . . . . . . . . . -0.0007824066
employment_statusNot in Labor Force . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
employment_statusUnemployed         . . . . . . . . . . . . . . . . . . . . . . . . . . . . -0.0010856842
census_msaMSA, Principle City       . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
census_msaNon-MSA                   . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
household_adults1                   . . . . . . . . . . . . . . . . . . . . . . . . . . . .  0.0007060287
household_adults2                   . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
household_adults3                   . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
household_children1                 . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
household_children2                 . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
household_children3                 . . . . . . . . . . . . . . . . . . . . . . . . . . . .  .           
                                                                                                    
rent_or_ownRent                     -0.002094580 -0.003455411 -0.004864162 -0.006319497 -0.007827438
employment_statusNot in Labor Force  .            .            .            .            .          
employment_statusUnemployed         -0.003553242 -0.006154802 -0.008889088 -0.011723089 -0.014688916
census_msaMSA, Principle City        .            .            .            .            .          
census_msaNon-MSA                    .            .            .            .            .          
household_adults1                    0.001761798  0.002855175  0.003983902  0.005160650  0.006374778
household_adults2                    .            .            .            .            .          
household_adults3                    .            .            .            .            .          
household_children1                  .            .            .            .            .          
household_children2                  .            .            .            .            .          
household_children3                  .            .            .            .            .          
                                                                                                     
rent_or_ownRent                     -0.0093835670 -0.010979901 -0.012591182 -0.014223983 -0.015872390
employment_statusNot in Labor Force  .             .            .            .            .          
employment_statusUnemployed         -0.0177814105 -0.020985650 -0.024285185 -0.027681124 -0.031164238
census_msaMSA, Principle City        .             .            .            .            .          
census_msaNon-MSA                    .             .            .            .            .          
household_adults1                    0.0076180151  0.008865712  0.010143638  0.011448139  0.012773450
household_adults2                    .             .            .            .            .          
household_adults3                   -0.0003234325 -0.002737113 -0.005240767 -0.007844569 -0.010549667
household_children1                  .             .            .            .            .          
household_children2                  .             .            .            .            .          
household_children3                  .             .            .           -0.001312517 -0.003741037
                                                                                                       
rent_or_ownRent                     -1.753095e-02 -0.0191901443 -0.0208352502 -0.022452396 -0.024019260
employment_statusNot in Labor Force  4.718437e-06  0.0009578985  0.0019375051  0.002938191  0.004020477
employment_statusUnemployed         -3.472219e-02 -0.0382575136 -0.0418188006 -0.045384621 -0.048891944
census_msaMSA, Principle City        .             .             .             .            .          
census_msaNon-MSA                    .             .             0.0005465998  0.001910085  0.003381153
household_adults1                    1.410699e-02  0.0154524928  0.0167958952  0.018130084  0.019446392
household_adults2                    .             .             .             .            .          
household_adults3                   -1.335057e-02 -0.0162400448 -0.0192206306 -0.022287658 -0.025454484
household_children1                  .             .             .             .            .          
household_children2                  .             .             .             .            .          
household_children3                 -6.313132e-03 -0.0090175742 -0.0118609573 -0.014839979 -0.017941686
                                          
rent_or_ownRent                     ......
employment_statusNot in Labor Force ......
employment_statusUnemployed         ......
census_msaMSA, Principle City       ......
census_msaNon-MSA                   ......
household_adults1                   ......
household_adults2                   ......
household_adults3                   ......
household_children1                 ......
household_children2                 ......
household_children3                 ......
R Console



Show in New WindowClear OutputExpand/Collapse Output
 
 
name
<chr>
coefficient
<dbl>
24	opinion_h1n1_risk5	0.299031242		
13	doctor_recc_h1n11	0.287688519		
23	opinion_h1n1_risk4	0.221305610		
20	opinion_h1n1_vacc_effective5	0.196000868		
16	health_worker1	0.143618320		
22	opinion_h1n1_risk3	0.100527581		
21	opinion_h1n1_risk2	0.056821821		
32	age_group65+ Years	0.056044008		
19	opinion_h1n1_vacc_effective4	0.047479900		
15	child_under_6_months1	0.043202403		
Next123Previous
1-10 of 30 rows
Show in New WindowClear OutputExpand/Collapse Output

Modify Chunk OptionsRun All Chunks AboveRun Current Chunk
Show in New WindowClear OutputExpand/Collapse Output
 [1] "opinion_h1n1_risk5"           "doctor_recc_h1n11"            "opinion_h1n1_risk4"          
 [4] "opinion_h1n1_vacc_effective5" "health_worker1"               "opinion_h1n1_risk3"          
 [7] "opinion_h1n1_risk2"           "age_group65+ Years"           "opinion_h1n1_vacc_effective4"
[10] "child_under_6_months1"        "age_group55 - 64 Years"       "raceOther or Multiple"       
[13] "educationCollege Graduate"    "raceWhite"                    "h1n1_concern3"               
[16] "opinion_h1n1_sick_from_vacc2" "opinion_h1n1_sick_from_vacc3" "(Intercept)"                 
Show in New WindowClear OutputExpand/Collapse Output
 Show Traceback
Error in `[.data.frame`(dt, , cols, with = FALSE) : unused argument (with = FALSE)
## Splitting Data into Training and Testing Set
```{r}
# Splitting the dataset into the Training set and Test set 
#install.packages('caTools') 
set.seed(03092000)
library(caTools) 
  
# Creating a 70/30 split
splitting_data <- sample(1:nrow(df),
               round(0.7 * nrow(df), 0), 
               replace = FALSE)

splitting_data_test <- sample(1:nrow(df),
               round(0.15 * nrow(df), 0), 
               replace = FALSE)

#Creating the train and test data
svm_train <- df[splitting_data, ] #Should contain 70% of data points
svm_test <- df[splitting_data_test, ] #Should contain 15% of data points

#Checking to ensure steps above were done correctly
size_of_training <- nrow(svm_train)
size_of_total <- nrow(df)
size_of_test <- nrow(svm_test)

#Verification
paste("The Training Set contains", toString(round(size_of_training/size_of_total,2)*100), "% of the total data")
paste("The Testing Set contains", toString(round(size_of_test/size_of_total,2)*100), "% of the total data")
```

## Creating the Model
```{r}
#install.packages('e1071') 
library(e1071) 

classifier <- svm(formula = h1n1_vaccine ~ ., 
                 data = svm_train, 
                 type = 'C-classification',  #Default
                 #can change degree 
                 kernel = 'polynomial')  #The kernel used in training and predicting

```
## Predicting the Test Set Results with Model
```{r}
# Predicting the test set results 
head(df)
y_pred <- predict(classifier, newdata = svm_test[-28]) 
```

## Creating Confusion Matrix
```{r}
# Making a Confusion Matrix 
#install.packages("caret")
library(caret)
cm <- confusionMatrix(svm_test$h1n1_vaccine,y_pred, positive = "1")
cm
```

# References
1. <ftp://ftp.cdc.gov/pub/Health_Statistics/NCHS/Dataset_Documentation/NIS/nhfs/nhfspuf_DUG.PDF>
2. <https://www.cdc.gov/h1n1flu/surveillanceqa.htm>
3. <https://towardsdatascience.com/simplifying-precision-recall-and-other-evaluation-metrics-d066b527c6bb>